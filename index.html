<html>

<head>

    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <script type="text/javascript">

        const svg  = d3.select("body")
                    .append("svg")
                    .attr("viewBox", "0 0 600 600");

                    d3.csv("tiobe.csv", d => {
                        return	{
                            programming_language: d.pl,
                            count:	+d.count 
                        } 
                    }).then(data => {
                        console.log(data);
                        console.log(data.length);
                        console.log(d3.max(data, d => d.count));
                        console.log(d3.min(data, d => d.count));
                        console.log(d3.extent(data, d => d.count));
                        data.sort((a, b) => b.count - a.count);
                        console.log(data);
                        visualize(data);
                    });
                    
                    const visualize = (data) => {
                        const barHeight = 20;
                        svg
                            .selectAll("rect")
                            .data(data)
                            .join("rect")
                                .attr("width", d => d.count * 20)
                                .attr("height", barHeight )
                                .attr("x", 0)
                                .attr("y", (d, i) => (barHeight + 5) * i)
                                .attr("fill", 
                                    d => d.programming_language === "JavaScript" ? "green" : "lightblue"
                                    );

                    };
    </script>
    <div id="barchart">

    </div>
</body>
</html>