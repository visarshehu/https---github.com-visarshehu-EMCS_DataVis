<html>
    <head>
        <title>
            Hyrje ne d3js
        </title>
        <script src="https://d3js.org/d3.v7.min.js"></script>
 
    </head>
    <body>
      
        <script type="text/javascript">
const svg = d3.select("body")
  .append("svg")
  .attr("viewBox", "0 0 600 700");

d3.csv("tiobe.csv", d => {
   
  return {
    pl: d.pl,
    count: +d.count
  };
}).then(data => {

  console.log(data);

  console.log(data.length);    

  console.log(d3.max(data, d => d.count));      
  console.log(d3.min(data, d => d.count));      
  console.log(d3.extent(data, d => d.count));   

  data.sort((a, b) => b.count - a.count);

  visualize(data);
});


const visualize = (data) => {

  const xScale = d3.scaleLinear()
    .domain([0, d3.max(data, d => d.count)])
    .range([0, 450]);

  const yScale = d3.scaleBand()
    .domain(data.map(d => d.pl))
    .range([0, 400])
    .paddingInner(0.2);

  const barAndLabel = svg
    .selectAll("g")
    .data(data)
    .join("g")
      .attr("transform", d => `translate(0, ${yScale(d.pl)})`);
      
  barAndLabel
    .append("rect")
      .attr("width", d => xScale(d.count))
      .attr("height", yScale.bandwidth())
      .attr("x", 100)
      .attr("y", 0)
      .attr("fill", d => d.pl === "JavaScript" ? "yellowgreen" : "skyblue");

  barAndLabel
    .append("text")
      .text(d => d.pl)
      .attr("x", 96)
      .attr("y", 12)
      .attr("text-anchor", "end")
      .style("font-family", "sans-serif")
      .style("font-size", "11px");

    barAndLabel
      .append("text")
        .text(d => d.count)
        .attr("x", d => 100 + xScale(d.count) + 4)
        .attr("y", 12)
        .style("font-family", "sans-serif")
        .style("font-size", "9px");


};
        </script>
    </body>
</html>